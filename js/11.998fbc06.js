"use strict";(self["webpackChunkhappy_birthday"]=self["webpackChunkhappy_birthday"]||[]).push([[11],{2648:function(e,t,s){function i(e,t,s,i){let n=String(o(Number(e),Number(t),s).toFixed(i+1)),a=Number(n.slice(0,n.length-1));return a}function n(e){return Math.floor(e)===e}function a(e){var t={times:1,num:0};if(n(e))return t.num=e,t;var s=e+"",i=s.indexOf("."),a=s.substr(i+1).length,o=Math.pow(10,a),h=parseInt(e*o+.5,10);return t.times=o,t.num=h,t}function o(e,t,s){var i=a(e),n=a(t),o=i.num,h=n.num,l=i.times,m=n.times,r=l>m?l:m,u=null;switch(s){case"add":return u=l===m?o+h:l>m?o+h*(l/m):o*(m/l)+h,u/r;case"sub":return u=l===m?o-h:l>m?o-h*(l/m):o*(m/l)-h,u/r;case"mul":return u=o*h/(l*m),u;case"div":return u=o/h/(l/m),u}}s.d(t,{R7:function(){return i}})},9011:function(e,t,s){s.r(t),s.d(t,{default:function(){return b}});var i=s(6252);const n=e=>((0,i.dD)("data-v-2286ab50"),e=e(),(0,i.Cn)(),e),a={class:"container"},o=n((()=>(0,i._)("div",{class:""},"此页面除canvas拖动缩放以外的功能均待实现",-1))),h={class:"scale-button"},l=(0,i.Uk)("点击上传"),m=n((()=>(0,i._)("div",{slot:"tip",class:"el-upload__tip"},"只能上传jpg/png文件，且不超过500kb",-1))),r=n((()=>(0,i._)("div",{id:"img-container",class:"img-container"},[(0,i._)("div",{id:"canvas-shell",class:"canvas-shell"},[(0,i._)("canvas",{id:"canvas"})])],-1)));function u(e,t,s,n,u,d){const c=(0,i.up)("el-button"),p=(0,i.up)("el-upload");return(0,i.wg)(),(0,i.iD)("div",a,[o,(0,i._)("div",h,[(0,i._)("button",{onClick:t[0]||(t[0]=t=>e.zoom("add"))},"+"),(0,i._)("button",{onClick:t[1]||(t[1]=t=>e.zoom("sub"))},"-")]),(0,i.Wm)(p,{class:"upload-demo",action:"https://jsonplaceholder.typicode.com/posts/","on-preview":d.handlePreview,"on-remove":d.handleRemove,"on-success":d.handleSuccess,"before-remove":d.beforeRemove,multiple:"",limit:3,"on-exceed":d.handleExceed,"file-list":e.fileList},{default:(0,i.w5)((()=>[(0,i.Wm)(c,{size:"small",type:"primary"},{default:(0,i.w5)((()=>[l])),_:1}),m])),_:1},8,["on-preview","on-remove","on-success","before-remove","on-exceed","file-list"]),r])}function d(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var c=s(2648);class p{constructor(e,t={imgUrl:"",width:0,height:0,shellName:"",outDomName:""}){d(this,"moveSet",{x:0,y:0}),d(this,"transSet",{x:0,y:0}),d(this,"x",0),d(this,"y",0),d(this,"img",""),d(this,"multiple",1),d(this,"handleBorder",((e,t,s,i,n)=>{let a,o,{clientWidth:h,clientHeight:l}=e,{clientWidth:m,clientHeight:r}=t;return h*n>m||l*n>r?h*n>m&&h*n>r?(a=Math.min(Math.max(s,m-h*(n+1)/2),h*(n-1)/2),o=Math.min(Math.max(i,r-l*(n+1)/2),l*(n-1)/2)):h*n>m&&!(h*n>r)?(a=Math.min(Math.max(s,m-h*(n+1)/2),h*(n-1)/2),o=Math.max(Math.min(i,r-l*(n+1)/2),l*(n-1)/2)):!(h*n>m)&&h*n>r&&(a=Math.max(Math.min(s,m-h*(n+1)/2),h*(n-1)/2),o=Math.min(Math.max(i,r-l*(n+1)/2),l*(n-1)/2)):(a=Math.max(Math.min(s,m-h*(n+1)/2),h*(n-1)/2),o=Math.max(Math.min(i,r-l*(n+1)/2),l*(n-1)/2)),{transX:a,transY:o}})),this.canvas=document.getElementById(e),this.options=t,this.width=t.width,this.height=t.height,this.canvas.width=t.width,this.canvas.height=t.height,this.ctx=this.canvas.getContext("2d"),this.shell=document.getElementById(t.shellName),this.setShellData(t.width,t.height),this.outDom=document.getElementById(t.outDomName),this.onMousedown=this.onMousedown.bind(this),this.onMousemove=this.onMousemove.bind(this),this.onMouseup=this.onMouseup.bind(this),this.onWheel=this.onWheel.bind(this),this.canvas.addEventListener("mousedown",this.onMousedown),this.canvas.addEventListener("wheel",this.onWheel)}onMousedown(e){0===e.button&&(this.x=e.clientX-this.transSet.x,this.y=e.clientY-this.transSet.y,window.addEventListener("mousemove",this.onMousemove),window.addEventListener("mouseup",this.onMouseup))}onMousemove(e){this.moveSet.x=(0,c.R7)(e.clientX,this.x,"sub",2),this.moveSet.y=(0,c.R7)(e.clientY,this.y,"sub",2),this.paint()}onMouseup(){window.removeEventListener("mousemove",this.onMousemove),window.removeEventListener("mouseup",this.onMouseup)}onWheel(e){e.deltaY<0?this.multiple=(0,c.R7)(this.multiple,.1,"add",1):e.deltaY>=0&&Number(this.multiple).toFixed(1)>.1&&(this.multiple=(0,c.R7)(this.multiple,.1,"sub",1)),this.canvas.style.transform=`scale(${this.multiple})`}setShellData(e,t){this.shell.style.width=`${e}px`,this.shell.style.height=`${t}px`}draw(){if(this.img)this.ctx.drawImage(this.img,0,0);else{let e=new Image;e.src=this.options.imgUrl,e.onload=()=>{this.img=e,this.ctx.drawImage(e,0,0)}}}clear(){this.canvas.width=this.width}paint(){this.clear();const{transX:e,transY:t}=this.handleBorder(this.canvas,this.outDom,this.moveSet.x,this.moveSet.y,this.multiple);this.transSet.x=e,this.transSet.y=t,this.shell.style.transform=`translate(${e}px, ${t}px)`,this.draw()}}var v={name:"convertImgIntoCanvas",components:{},data:()=>({fileList:[{name:"food.jpeg",url:"https://fuss10.elemecdn.com/3/63/4e7f3a15429bfda99bce42a18cdd1jpeg.jpeg?imageMogr2/thumbnail/360x360/format/webp/quality/100"},{name:"food2.jpeg",url:"https://fuss10.elemecdn.com/3/63/4e7f3a15429bfda99bce42a18cdd1jpeg.jpeg?imageMogr2/thumbnail/360x360/format/webp/quality/100"}]}),computed:{},mounted(){const e="https://fuss10.elemecdn.com/3/63/4e7f3a15429bfda99bce42a18cdd1jpeg.jpeg?imageMogr2/thumbnail/360x360/format/webp/quality/100";let t={imgUrl:e,width:466,height:466,shellName:"canvas-shell",outDomName:"img-container"},s=new p("canvas",t);s.draw()},methods:{handleRemove(e,t){console.log(e,t)},handlePreview(e){console.log(e)},handleSuccess(e,t,s){console.log(e,t,s)},handleExceed(e,t){this.$message.warning(`当前限制选择 3 个文件，本次选择了 ${e.length} 个文件，共选择了 ${e.length+t.length} 个文件`)},beforeRemove(e,t){return this.$confirm(`确定移除 ${e.name}？`)}}},g=s(3744);const w=(0,g.Z)(v,[["render",u],["__scopeId","data-v-2286ab50"]]);var b=w}}]);
//# sourceMappingURL=11.998fbc06.js.map